swagger: '2.0'
info:
  title: API
  version: 1.0.0
host: ekcoffee2-3000.terminal.com
schemes:
  - https
basePath: /v1
produces:
  - application/json
consumes:
  - application/json
tags:
  - name: Profiles
    description: CRUD operations on a user profile
  - name: Photos
    description: CRUD operations on a user's profile photos
  - name: Matches
    description: Operations on a user's matches
  - name: Conversations
    description: CRUD operations for user conversations
  - name: Accounts
    description: Operations for a user's account settings
paths:
  /profiles:
    post:
      tags:
        - Profiles
      summary: Create Profile/New User Signup
      description: The parameters required to create a new profile should include the full Facebook OAuth response object.
      parameters:
        - name: data
          in: body
          description: Parameters for profile to be created
          required: true
          schema:
            type: object
            required:
              - facebook_auth_hash
              - intent
              - latitude
              - longitude
            properties:
              facebook_auth_hash:
                description: full response object from auth provider
                type: string
              intent:
                description: dating intention
                type: string
                enum:
                  - Dating
                  - Relationship
              latitude:
                description: latitude as on profile
                type: number
                format: double
              longitude:
                description: longitude as on profile
                type: number
                format: double
      responses:
        201:
          description: newly created profile object
          schema:
            type: object
            properties:
              data:
                $ref: '#/definitions/Profile'
              auth:
                $ref: '#/definitions/AuthToken'
        400:
          description: Validation failed. Bad data.
          schema:
            type: object
            properties:
              error:
                $ref: '#/definitions/Error'
              auth:
                $ref: '#/definitions/AuthToken'
        403:
          description: Forbidden. Operation not permitted for this profile.
          schema:
            type: object
            properties:
              error:
                $ref: '#/definitions/Error'
              auth:
                $ref: '#/definitions/AuthToken'
        500:
          description: Unexpected error
          schema:
            type: object
            properties:
              error:
                $ref: '#/definitions/Error'
              auth:
                $ref: '#/definitions/AuthToken'
  /profiles/:uuid:
    delete:
      tags:
        - Profiles
      summary: Delete Profile/User Account
      description: This is effectively a 'delete account' method. The client should log the user out upon successful response.
      responses:
        500:
          description: 'Unexpected Error'
          schema:
            type: object
            properties:
              error:
                $ref: '#/definitions/Error'
              auth:
                $ref: '#/definitions/AuthToken'
    get:
      tags:
        - Profiles
      summary: Get Profile Details
      responses:
        200:
          description: profile object
          schema:
            $ref: '#/definitions/Profile'
        500:
          description: 'Unexpected Error'
          schema:
            type: object
            properties:
              error:
                $ref: '#/definitions/Error'
              auth:
                $ref: '#/definitions/AuthToken'
    post:
      tags:
        - Profiles
      summary: Update Profile
      responses:
        200:
          description: updated profile object
          schema:
            $ref: '#/definitions/Profile'
        500:
          description: 'Unexpected Error'
          schema:
            type: object
            properties:
              error:
                $ref: '#/definitions/Error'
              auth:
                $ref: '#/definitions/AuthToken'
  /profiles/sign_in:
    post:
      tags:
        - Profiles
      summary: Login an existing user
      description: Login existing user with their FB credentials
      parameters:
        - name: facebook_auth_hash
          in: body
          description: full auth hash from FB login response
          required: true
          schema:
            type: string
            description: omniauth hash
      responses:
        200:
          description: logged-in profile object
          schema:
            $ref: '#/definitions/Profile'
        404:
          description: User not found
          schema:
            type: object
            properties:
              error:
                $ref: '#/definitions/Error'
              auth:
                $ref: '#/definitions/AuthToken'
        500:
          description: Unexpected error
          schema:
            type: object
            properties:
              error:
                $ref: '#/definitions/Error'
              auth:
                $ref: '#/definitions/AuthToken'
  /profiles/:uuid/photos:
    post:
      tags:
        - Photos
      summary: Add new photo to profile
      responses:
        500:
          description: 'Unexpected Error'
          schema:
            type: object
            properties:
              error:
                $ref: '#/definitions/Error'
              auth:
                $ref: '#/definitions/AuthToken'
  /profiles/:uuid/photos/:uuid:
    delete:
      tags:
        - Photos
      summary: Delete photo
      responses:
        500:
          description: 'Unexpected Error'
          schema:
            type: object
            properties:
              error:
                $ref: '#/definitions/Error'
              auth:
                $ref: '#/definitions/AuthToken'
  /profiles/:uuid/photos:
    get:
      tags:
        - Photos
      summary: Get all profile photos
      responses:
        500:
          description: 'Unexpected Error'
          schema:
            type: object
            properties:
              error:
                $ref: '#/definitions/Error'
              auth:
                $ref: '#/definitions/AuthToken'
  /profiles/:uuid/photos/:uuid:
    get:
      tags:
        - Photos
      summary: Get a specific photo
      responses:
        500:
          description: 'Unexpected Error'
          schema:
            type: object
            properties:
              error:
                $ref: '#/definitions/Error'
              auth:
                $ref: '#/definitions/AuthToken'
definitions:
  Profile:
    type: object
    properties:
      uuid:
        description: profile uuid
        type: string
        readOnly: true
      email:
        description: email address
        type: string
        readOnly: true
      firstname:
        description: first name
        type: string
        readOnly: true
      lastname:
        description: last name
        type: string
        readOnly: true
      age:
        description: age
        type: integer
        readOnly: true
        format: int32
        minimum: 21
        maximum: 99
      gender:
        description: gender
        type: string
        readOnly: true
        enum:
          - Male
          - Female
      height:
        description: height
        type: string
        enum:
          - 4'0"
          - 4'1"
          - 4'2"
          - 4'3"
          - 4'4"
          - 4'5"
          - 4'6"
          - 4'7"
          - 4'8"
          - 4'9"
          - 4'10"
          - 4'11"
          - 5'
          - 5'1"
          - 5'2"
          - 5'3"
          - 5'4"
          - 5'5"
          - 5'6"
          - 5'7"
          - 5'8"
          - 5'9"
          - 5'10"
          - 5'11"
          - 6'
          - 6'1"
          - 6'2"
          - 6'3"
          - 6'4"
          - 6'5"
          - 6'6"
          - 6'7"
          - 6'8"
          - 6'9"
      profession:
        description: occupation
        type: string
        maximum: 50
      highest_degree:
        description: highest degree
        type: string
        enum:
          - Bachelors
          - Masters
          - Doctorate
      faith:
        description: faith/religion/belief
        type: string
        enum:
          - Agnostic
          - Atheist
          - Baha'i
          - Buddhist
          - Jain
          - Hindu
          - Muslim
          - Parsi/Zoroastrian
          - Sikh
          - Spiritual
      last_known_latitude:
        description: current/last known latitude
        type: number
        format: double
      last_known_longitude:
        description: current/last known longitude
        type: number
        format: double
  AuthToken:
    type: object
    properties:
      auth_token:
        type: string
        description: auth token (json web token)
      expires_at:
        type: string
        description: auth token expiration DateTime in iso8601 format
        format: date-time
  Error:
    type: object
    properties:
      message:
        type: string
        description: error string
      code:
        type: integer
        description: HTTP status code
        format: int32
